---
date: '2023-10-08'
title: 'Using GraphQL Typegen with Gatsby'
tags: ['typescript', 'gatsby', 'react']
slug: typescript-gatsby
featuredImage: tscript.jpg
author: James A. Hernandez
status: published
showTOC: true
prismThemes: ['prism-coldark-dark', 'prism-ghcolors']
description: "If you've adopted TypeScript into your React projects, you know it's sometimes a blessing and sometimes a lot of work. Particularly if you are manually typing your queries, it's nice to know there's an easier way to go about it."
---

import H2ThemeWrapper from 'wrappers/H2ThemeWrapper';
import CodeSection from 'components/CodeSection';
import BetterImageModal from 'components/BetterImageModal';
import AutoQuery from './auto-query-generation.jpg';
import CompBox from 'components/CompBox';


<CompBox techItems={["Node 18","React 18", "Gatsby 5", "TypeScript 5"]} />

<H2ThemeWrapper>Using GraphQL Typegen</H2ThemeWrapper>

Upon creating a JavaScript codebase in TypeScript I want to stay true to adding all type definitions, but I'm the first to tell you there are some times it's just so tedious I end up using `variable: any`. This is particularly true if the object is a query, especially if there's something that automates it, right?

It turns out Gatsby has a good feature called GraphQL Typegen just for this circumstance. If you've arrived here, chances are you've already gone through the [documentation](https://www.gatsbyjs.com/docs/how-to/local-development/graphql-typegen/) on Gatsby's website. I followed the instructions, but had trouble with one part of the whole procedure that made all the difference.

The first thing of course, is setting `graphqlTypegen` to true.

<CodeSection height='20' darkTheme="prism-coldark-dark" lightTheme="prism-ghcolors">
```tsx
// gatsby-config.ts

module.exports = {
  graphqlTypegen: true,
}
  ```
</CodeSection>

The instructions should also let you know to add the autogenerated file (`gatsby-types.d.ts`) name to your `tsconfig.json` file.

<CodeSection height='20' darkTheme="prism-coldark-dark" lightTheme="prism-ghcolors">
```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "esnext",
    "lib": ["dom", "esnext"],
    "jsx": "react-jsx",
    "module": "esnext",
    "baseUrl": "src",
    "moduleResolution": "node",
    "esModuleInterop": true,
    "resolveJsonModule": true,
    "inlineSources": true,
    "forceConsistentCasingInFileNames": true,
    "strict": false,
    "sourceMap": true,
    "sourceRoot": "/",
    "skipLibCheck": true,
    "paths": {
      "@/*": ["./src/*"],
      "@/static/*": ["./static/*"]
    },
    "types": ["node", "@testing-library/jest-dom"]
  },
  "exclude": ["node_modules"],
  "include": [
    "./src",
    "./src/**/*",
    "./gatsby-node.ts",
    "./gatsby-config.ts",
    "./plugins/**/*",
    ".d.ts",
    "gatsby-types.d.ts"
  ]
}

```
</CodeSection>


The one caveat? You have to name all your queries, like this:

<CodeSection height='20' darkTheme="prism-coldark-dark" lightTheme="prism-ghcolors">
```graphql
  query Alpine {
    publishedPosts: allMdx(
      sort: { frontmatter: { date: ASC } }
      filter: { frontmatter: { status: { in: ["published"] } } }
    ) {
      nodes {
        id
        frontmatter {
          tags
        }
        fields {
          slug
        }
        internal {
          contentFilePath
        }
      }
    }

```
</CodeSection>

If you miss naming one of your queries, or adopt the same name for two or more, you will get an error. 

This file only generates during `gatsby develop`. Once this file is generated you will be able to use autocomplete to type the results of your queries.

<BetterImageModal 
imageUrlFromFolder={AutoQuery}
title="Auto Query Generation"
initialSize="30rem"
frameStyles="p-3"
modalSize='xl'
border
preventShow
modalImageSize="xlargeImageModal"
/>

